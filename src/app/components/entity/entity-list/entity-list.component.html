<h1>Lista de Entidades</h1>
  <div class="card-body">
    <!-- ESTE COMPONENTE LO VAN A TENER QUE MODIFICAR ES EL DEL BUSCAR, EXPORTAR, ETC -->
    <!-- @param itemList => Mandan la lista con la cual hacen la tabla
         @param tableName => Mandan el nombre de la tabla el que definen con #
         @param tableName => Mandan el nombre de la tabla el que definen con #
         @param formPath => Van a poner la ruta de su formulario para crear uno nuevo
         @param dictionaries => En caso de usar diccionarios mandenlos, si no los mandan no pasa nada
         @param objectName => Hace referencia al nombre de su objeto para guardar el archivo pdf o excel. Ej: 25/10/2024_LOTES
         -->
    <app-cadastre-plot-filter-buttons
      #filterComponent
      [itemsList]="completeList"
      [tableName]="tableName.nativeElement"
      [heads]="heads"
      [props]="props"
      formPath="/entity/form"
      [dictionaries]="dictionaries"
      objectName="ACCESOS"></app-cadastre-plot-filter-buttons>

    <div class="d-flex justify-content-between align-items-center mb-3">
      <div class="btn-group me-5" role="group">
        <div class="d-flex align-items-center">
          <div class="btn-group me-2">
            <button type="button" class="btn btn-outline-danger" (click)="changeFilterMode(filterTypes.NOTHING)">
              <i class="bi bi-trash-fill"></i> Limpiar filtros
            </button>

            <button type="button" class="btn btn-outline-info dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-funnel-fill"></i> Filtros
            </button>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" (click)="changeFilterMode(filterTypes.VISITOR_TYPE)">Tipo de visitante</a></li>
            </ul>
          </div>

          @if (applyFilterWithNumber === true || applyFilterWithCombo === true) {
            <div class="d-flex">
              @if (applyFilterWithNumber === true) {
                <input type="number" class="form-control me-2" id="filter-number" [(ngModel)]="filterInput" name="ngModel" placeholder="Número">
              } @else if (applyFilterWithCombo === true) {
                <select id="content-filter" class="form-select me-2" [(ngModel)]="filterInput" name="ngModel">
                  <option disabled selected>Selecciona un filtro</option>
                  @for (content of contentForFilterCombo; track content) {
                    <option value="{{content}}">{{content}}</option>
                  }
                </select>
              }
              <div class="ms-auto">
                <button class="btn btn-dark" type="button" (click)="confirmFilter()">Buscar</button>
              </div>
            </div>
          }
        </div>
      </div>


      <!--      <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
              <input type="radio" class="btn-check"
                     name="btnradio" id="btnradio1"
                     autocomplete="off" (change)="changeActiveFilter(true)" checked>
              <label class="btn btn-outline-primary" for="btnradio1">Lotes Activos</label>

              <input type="radio" class="btn-check"
                     name="btnradio" id="btnradio2"
                     autocomplete="off" (change)="changeActiveFilter(false)">
              <label class="btn btn-outline-primary" for="btnradio2">Lotes Inactivos</label>

              <input type="radio" class="btn-check"
                     name="btnradio" id="btnradio3"
                     autocomplete="off" (change)="changeActiveFilter()">
              <label class="btn btn-outline-primary" for="btnradio3">Todos</label>
            </div>-->
    </div>

    <div class="table-container">
      <table class="table table-striped fixed-table" style="border: 1px solid rgba(0, 0, 0, 0.150); border-collapse: collapse;" #table>
        <thead>
        <tr>
          <th scope="col">Nombre</th>
          <th scope="col">Documento</th>
          <th scope="col">Tipo</th>
          @if (userType == "ADMIN"|| userType == "OWNER"){
            <th scope="col">Activo</th>
            <th scope="col">Acciones</th>
          }
        </tr>
        </thead>
        <tbody>
          @for (item of (filteredList.length ? filteredList : list); track item) {

            <tr>
              <td>
                <!--TODO icono-->
                {{ item.name + ' ' + (item.last_name == null ? '' : item.last_name) }}
              </td>
              <td>
                {{ (item.doc_type === "PASSPORT" ? "PASAPORTE" : item.doc_type) + ' ' + item.doc_number }}
              </td>
              <td>
                @for (type of item.visitor_types; track $index){
                  {{ translateTable(type, typeDictionary) }}
                }
              </td>
              @if (userType == "ADMIN" || userType == "OWNER"){
                <td>
                  @if (item.is_active) {
                    <p class="mb-0">
                      <i class="bi bi-check2-circle text-success" style="font-size: 1.5rem;"></i>
                    </p>
                  } @else {
                    <p class="mb-0">
                      <i class="bi bi-x-circle text-danger" style="font-size: 1.5rem;"></i>
                    </p>
                  }
                </td>
                <td>
                  <button class="btn btn-warning"> <i class="bi bi-pencil" (click)="edit(item.doc_number)"></i></button>
                  <button class="btn btn-danger ms-1"> <i class="bi bi-trash"></i></button>
                </td>
              }
              <!--<td>
                  &lt;!&ndash; Botones visibles en pantallas medianas y grandes &ndash;&gt;
                  <div class="d-none d-md-flex">
                    <button class="btn btn-warning btn-sm me-2" (click)="editVisitor(item.visitor_id)">
                      Editar
                    </button>
                    <button class="btn btn-danger btn-sm" (click)="deleteVisitor(item.visitor_id)">
                      Eliminar
                    </button>
                  </div>

                  &lt;!&ndash; Botones visibles solo en pantallas pequeñas &ndash;&gt;
                  <div class="d-md-none" ngbDropdown>
                    <button class="btn" type="button" id="dropdownMenuButton2"  aria-expanded="false">
                      <i class="bi bi-three-dots-vertical" ngbDropdownToggle aria-expanded="false"></i> &lt;!&ndash; Mantenemos solo el ícono &ndash;&gt;
                    </button>

                    <div ngbDropdownMenu class="dropdown-menu-dark" aria-labelledby="dropdownMenuButton2">
                      <button class="dropdown-item" (click)="editVisitor(item.visitor_id)">
                        Editar
                      </button>
                      <button class="dropdown-item text-white" (click)="deleteVisitor(item.visitor_id)">
                        Eliminar
                      </button>
                    </div>
                  </div>
              </td>-->
            </tr>

          }
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-3">

      <div class="form-group mb-3 me-2">
        <select
          id="itemsPerPage"
          class="form-select"
          [(ngModel)]="pageSize"
          (change)="onItemsPerPageChange()"
        >
          @for(option of sizeOptions; track $index) {
            <option [value]="option">{{ option }} Elementos</option>
          }
        </select>
      </div>

      <div class="ms-auto">
      </div>

      <div class="d-flex">

        <ngb-pagination
          [(page)]="currentPage"
          [pageSize]="pageSize"
          [collectionSize]="totalItems"
          (pageChange)="onPageChange($event)"
          [maxSize]="5"
          [boundaryLinks]="false"
        ></ngb-pagination>

        <div class="ms-2">
          <button class="btn btn-secondary ms-3 mb-3" (click)="onInfoButtonClick()">
            <i class="bi bi-info-circle"></i>
          </button>
        </div>
      </div>

    </div>
  </div>

  <ng-template #infoModal let-modal>
    <div class="modal-header fs-6 py-1">
      <h4 class="modal-title">Información de la Lista de entidades</h4>
      <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss()"></button>
    </div>
    <div class="modal-body fs-6 py-2">
      <div class="container-fluid">
        <!-- Introducción -->
        <div class="alert alert-info mb-2 py-2">
          <h5 class="alert-heading">¿Qué es esta pantalla?</h5>
          <p class="mb-0 small">Esta pantalla permite visualizar y gestionar los registros de visitantes. Puedes ver los detalles de cada visitante, aplicar filtros, y realizar acciones específicas sobre cada registro.</p>
        </div>

        <!-- Campos Principales -->
        <div class="card mb-2">
          <div class="card-header py-1">
            <h5 class="mb-0">Datos de Visitantes</h5>
          </div>
          <div class="card-body py-2">
            <ul class="list-group list-group-flush">
              <li class="list-group-item py-1">
                <strong>Lista de Visitantes:</strong> Muestra los detalles de cada visitante, incluyendo nombre, apellido, tipo y número de documento.
              </li>
              <li class="list-group-item py-1">
                <strong>Filtros:</strong> Permite aplicar filtros como el tipo de visitante para acceder de manera facil a los registros que coincidan con el tipo de visitante de manera rápida.
              </li>
              <li class="list-group-item py-1">
                <strong>Paginación:</strong> Control para navegar entre múltiples páginas de registros de visitantes.
              </li>
              <li class="list-group-item py-1">
                <strong>Exportar:</strong> Opción para exportar la lista de visitantes en formato PDF o Excel.
              </li>
            </ul>
          </div>
        </div>

        <!-- Acciones -->
        <div class="card mb-2">
          <div class="card-header py-1">
            <h5 class="mb-0">Acciones Disponibles</h5>
          </div>
          <div class="card-body py-2">
            <ul class="list-group list-group-flush">
              <li class="list-group-item py-1">
                <strong>Buscar:</strong> Filtra la lista de visitantes mediante campos de texto o selección para localizar registros específicos.
              </li>
              <li class="list-group-item py-1">
                <strong>Limpiar Filtros:</strong> Restablece los filtros aplicados para mostrar la lista completa de visitantes.
              </li>
            </ul>
          </div>
        </div>

        <!-- Nota (OPCIONAL) -->
        <div class="alert alert-warning py-2 mb-0">
          <h5 class="alert-heading">Nota:</h5>
          <p class="mb-0 small">Verifica la información antes de realizar cambios o eliminar registros de visitantes. Asegúrate de que los datos de los visitantes y autorizadores sean correctos.</p>
        </div>
      </div>
    </div>
    <div class="modal-footer py-2">
      <button type="button" class="btn btn-primary" (click)="modal.close()">Entendido</button>
    </div>
  </ng-template>
